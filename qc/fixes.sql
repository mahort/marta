1.) to visualize:
select name,child.taxonid as kidid,parent.taxonid as mommaid,grandpa.taxonid as grandpaid,child.rank as kidrank,parent.rank as mommarank,grandpa.rank as grandparank from nodes child inner join nodes parent on parent.taxonid = child.parenttaxonid inner join nodes grandpa on grandpa.taxonid = parent.parenttaxonid left join names on child.taxonid = names.taxonid where child.rank = 'species' and grandpa.rank = 'family' and parent.rank = 'no rank' and class='scientific name' and name not like '% sp.%' and name not like '%environmental%' and name not like '%idae %' and name not like '%aceae %' and name not like '% cf. %' and name not like '%phage%' and name not like '%virus%' and name not like '%uncultured%' and name not like '%unidentified%' and name like 'Pseudomonas%';


select parent.taxonid as mommaid from nodes child inner join nodes parent on parent.taxonid = child.parenttaxonid inner join nodes grandpa on grandpa.taxonid = parent.parenttaxonid left join names on child.taxonid = names.taxonid where child.rank = 'species' and grandpa.rank = 'family' and parent.rank = 'no rank' and class='scientific name' and name not like '% sp.%' and name not like '%environmental%' and name not like '%idae %' and name not like '%aceae %' and name not like '% cf. %' and name not like '%phage%' and name not like '%virus%' and name not like '%uncultured%' and name not like '%unidentified%' and name like 'Pseudomonas%';
select name,child.taxonid as kidid,parent.taxonid as mommaid,grandpa.taxonid as grandpaid,child.rank as kidrank,parent.rank as mommarank,grandpa.rank as grandparank from nodes child inner join nodes parent on parent.taxonid = child.parenttaxonid inner join nodes grandpa on grandpa.taxonid = parent.parenttaxonid left join names on child.taxonid = names.taxonid where child.rank = 'species' and grandpa.rank = 'family' and parent.rank = 'no rank' and class='scientific name' and name not like '% sp.%' and name not like '%environmental%' and name not like '%idae %' and name not like '%aceae %' and name not like '% cf. %' and name not like '%phage%' and name not like '%virus%' and name not like '%uncultured%' and name not like '%unidentified%' and name like 'Pseudomonas%';
